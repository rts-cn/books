\documentclass[$if(fontsize)$$fontsize$,$endif$$if(lang)$$lang$,$endif$CJKutf8]{$documentclass$}
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt
\usepackage[top=1in,bottom=1in,left=1.25in,right=1.25in]{geometry}
\usepackage{float}
\usepackage{fontspec}
\newfontfamily\zhfont[BoldFont=Adobe Heiti Std]{Adobe Song Std}
\newfontfamily\zhpunctfont{Adobe Song Std}
\setmainfont{Times New Roman}
\usepackage{indentfirst}
\usepackage{zhspacing}
\zhspacing

% \usepackage[papersize={19cm, 23.6cm},text={15cm, 18.6cm}]{geometry}
% \usepackage[text={15cm, 18.6cm}]{geometry}
% \addtolength{\oddsidemargin}{-0.6cm}
% \addtolength{\evensidemargin}{0.4cm}

\usepackage{longtable}
% \let\longtableOLD\longtable
% \def\longtable{\longtableOLD\small}

\usepackage{indentfirst}
\setlength{\parindent}{2em}
% \renewcommand\thechapter{}
\providecommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\usepackage{fancyvrb}
\DefineVerbatimEnvironment{verbatim}{Verbatim}
{frame=none,
baselinestretch=1,
fontfamily="Souce Code Pro"
fontsize=\small,
xleftmargin=5pt,
xrightmargin=5pt,
rulecolor=\color{grey},
framesep=5mm,
numbers=left,
samepage=true
}

% \usepackage{perpage} %the perpage package
% \MakePerPage{footnote} %the perpage package command

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyhead[CO,CE]{$book$}
\fancyfoot[C]{------------ 版权所有，侵权必究 -----------}
\fancyfoot[RO, LE] {\thepage}
\fancyhead[LE,RO]{\chaptermark}
\fancyhead[LO,RE]{\sectionmark}

\renewcommand{\contentsname}{目\quad 录}
\renewcommand\listfigurename{插图目录}
\renewcommand\listtablename{表格目录}
% \renewcommand\refname{参考文献}
\renewcommand\indexname{索引}
\renewcommand\figurename{图}
\renewcommand\tablename{表}
\renewcommand\abstractname{摘要}
\renewcommand\partname{第\,\thepart\,部分}
\renewcommand\appendixname{附录}
\renewcommand\today{\number\year年\number\month月\number\day日}
\providecommand{\CJKnumber}[1]{\ifcase#1\or{一}\or{二}\or{三}\or{四}\or{五}\or{六}\or{七}\or{八}\or{九}\or{十}\or{十一}\or{十二}\or{十三}\or{十四}\or{十五}\or{十六}\or{十七}\or{十八}\or{十九}\or{二十}\or{二十一}\or{二十二}\or{二十三}\or{二十四}\or{二十五}\or{二十六}\or{二十七}\or{二十八}\or{二十九}\or{三十}\fi}

% \renewcommand{\thesection}{\Alph{section}}

\usepackage{titlesec}
\titleformat{\chapter}{\centering\Huge\bfseries}{第\,\CJKnumber{\thechapter}\,章}{1em}{}
\renewcommand{\chaptername}{第\CJKnumber{\thechapter}章}

\titleformat{\part}{\centering\Huge\bfseries}{第\,\thepart\,部分}{1em}{}
\renewcommand\partname{第\,\thepart\,部分}


\usepackage{fancyvrb}
\fvset{fontsize=\footnotesize}
\fvset{xleftmargin=0cm}
\fvset{frame=lines,framerule=0.4pt,rulecolor=\color{cyan},framesep=3mm}
% \fvset{commandchars=\\\{\}}
\RecustomVerbatimEnvironment{verbatim}{Verbatim}{}

\usepackage[usenames, dvipsnames]{color}
\definecolor{mygray}{gray}{0.9}

\usepackage{listings}
\lstset{ % General setup for the package
	language=perl,
	basicstyle=\small\sffamily,
	numbers=left,
 	numberstyle=\tiny,
	frame=tb,
	tabsize=4,
	columns=fixed,
	showstringspaces=false,
	showtabs=false,
	keepspaces,
	commentstyle=\color{red},
	keywordstyle=\color{blue},
	backgroundcolor=\color{mygray},
	rulecolor=\color{cyan},
	% fancyvrb=true,
  % xleftmargin=\parindent,
	breaklines=true
}

% \newfontfamily\quotefont[]{STKaiti}
% \let\quoteOLD\quote
% \def\quote{\quoteOLD\small\quotefont\selectfont}
\let\quoteOLD\quote
\def\quote{\quoteOLD\small}

\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
% use microtype if available
\IfFileExists{microtype.sty}{\usepackage{microtype}}{}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[utf8]{inputenc}
$if(euro)$
  \usepackage{eurosym}
$endif$
\else % if luatex or xelatex
  \usepackage{fontspec}
  \ifxetex
    \usepackage{xltxtra,xunicode}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{€}
$if(mainfont)$
    \setmainfont{$mainfont$}
$endif$
$if(sansfont)$
    \setsansfont{$sansfont$}
$endif$
$if(monofont)$
    \setmonofont{$monofont$}
$endif$
$if(mathfont)$
    \setmathfont{$mathfont$}
$endif$
\fi
$if(geometry)$
\usepackage[$for(geometry)$$geometry$$sep$,$endfor$]{geometry}
$endif$
$if(natbib)$
\usepackage{natbib}
\bibliographystyle{plainnat}
$endif$
$if(biblatex)$
\usepackage{biblatex}
$if(biblio-files)$
\bibliography{$biblio-files$}
$endif$
$endif$
$if(listings)$
\usepackage{listings}
$endif$
$if(lhs)$
\lstnewenvironment{code}{\lstset{language=Haskell,basicstyle=\small\ttfamily}}{}
$endif$
$if(highlighting-macros)$
$highlighting-macros$
$endif$
$if(verbatim-in-note)$
\usepackage{fancyvrb}
$endif$
$if(fancy-enums)$
% Redefine labelwidth for lists; otherwise, the enumerate package will cause
% markers to extend beyond the left margin.
\makeatletter\AtBeginDocument{%
  \renewcommand{\@listi}
    {\setlength{\labelwidth}{4em}}
}\makeatother
\usepackage{enumerate}
$endif$
$if(tables)$
\usepackage{ctable}
\usepackage{float} % provides the H option for float placement
$endif$
\let\Oldincludegraphics\includegraphics
$if(graphics)$
\usepackage{graphicx}
% We will generate all images so they have a width \maxwidth. This means
% that they will get their normal width if they fit onto the page, but
% are scaled down if they would overflow the margins.
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
\else\Gin@nat@width\fi}
\makeatother
\let\Oldincludegraphics\includegraphics
\renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=\maxwidth]{#1}}
$endif$
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={$author-meta$},
            pdftitle={$title-meta$},
            colorlinks=true,
            urlcolor=$if(urlcolor)$$urlcolor$$else$blue$endif$,
            linkcolor=$if(linkcolor)$$linkcolor$$else$magenta$endif$,
            pdfborder={0 0 0}}
$if(links-as-notes)$
% Make links footnotes instead of hotlinks:
\renewcommand{\href}[2]{#2\footnote{\url{#1}}}
$endif$
$if(strikeout)$
\usepackage[normalem]{ulem}
% avoid problems with \sout in headers with hyperref:
\pdfstringdefDisableCommands{\renewcommand{\sout}{}}
$endif$
\setlength{\parindent}{2em}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\renewcommand{\baselinestretch}{1.4}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
$if(numbersections)$
$else$
\setcounter{secnumdepth}{0}
$endif$
$if(verbatim-in-note)$
\VerbatimFootnotes % allows verbatim text in footnotes
$endif$
$if(lang)$
\ifxetex
  \usepackage{polyglossia}
  \setmainlanguage{$mainlang$}
\else
  \usepackage[$lang$]{babel}
\fi
$endif$
$for(header-includes)$
$header-includes$
$endfor$

$if(title)$
\title{$title$}
$endif$
\author{$for(author)$$author$$sep$ \and $endfor$}
\date{$date$}

\usepackage{afterpage}

\newcommand{\thetitle}{$book$}
\newcommand{\theauthor}{杜金房\ 等}
\newcommand{\theauthors}{杜金房\ 等}
\newcommand{\thepublisher}{版权所有，侵权必究}

\begin{document}
% \begin{CJK}{UTF8}{gbsn}
\thispagestyle{empty}
% \includepdf{/tmp/cover.pdf}

\afterpage{\clearpage}
\begin{figure}[t]
    \vspace*{-2.6cm}
    \makebox[\linewidth]{
        \Oldincludegraphics[width=\paperwidth]{images/cover.png}
    }
\end{figure}

\newpage
\thispagestyle{empty}
\pagenumbering{gobble}
\bigskip
\chapter*{}
\begin{center}
	{\Huge \bf \thetitle\\[1em]}
  {\Large\bf \theauthors \quad\\[2em]}
\end{center}

\vfill
\begin{center}
	\Large{\bf \thepublisher}
\end{center}

\newpage
\thispagestyle{empty}
\vspace*{2cm}
\noindent\quad \textbf{图书不在版编目（NCIP）数据}

\vspace{1em}

\noindent\quad \thetitle\ / \theauthor\ 著\ /\ 2016.7

\noindent\quad ISBN 7-DU-777777-7

\vspace*{2cm}

\noindent\quad {\bf 本书主要收集了一些真实的案例。}

\noindent\quad {\bf 阅读本书前强烈建议阅读《FreeSWITCH权威指南》以及《FreeSWITCH实例解析》。}

\bigskip

\vfill

{\bf \thetitle}

\begin{tabular}{cl}
  \hline
  {\bf 作\qquad 者} & \theauthor\\
  {\bf 封面设计    } & \theauthor\\
  {\bf 校\qquad 对} & \theauthor\\
  {\bf 排\qquad 版} & \theauthor\\
  {\bf 开\qquad 本} & 1890毫米 × 2360 毫米\\
  {\bf 印\qquad 张} & 7.5\\
  {\bf 印\qquad 数} & 7\\
  {\bf 版\qquad 数} & 2016年10月第1版 \qquad 2016年10月第1次发布\\
  {\bf 电子邮箱}   &  freeswitch@dujinfang.com \\
  \hline
\end{tabular}

\begin{center}
  {\bf 版权所有，侵权必究}
\end{center}

\newpage
\pagenumbering{arabic}
$if(title)$
\maketitle
$endif$

$for(include-before)$
$include-before$

$endfor$
$if(toc)$
{
\hypersetup{linkcolor=blue}
\tableofcontents
}
$endif$
$body$

$if(natbib)$
$if(biblio-files)$
$if(biblio-title)$
$if(book-class)$
\renewcommand\bibname{$biblio-title$}
$else$
\renewcommand\refname{$biblio-title$}
$endif$
$endif$
\bibliography{$biblio-files$}

$endif$
$endif$
$if(biblatex)$
\printbibliography$if(biblio-title)$[title=$biblio-title$]$endif$

$endif$

$for(include-after)$
$include-after$

$endfor$


% \end{CJK}
\end{document}
